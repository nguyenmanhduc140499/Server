{"code":"import { getClassWithAllParentClasses } from '~/services/utils/inheritance';\r\nimport { FieldError, fieldsRegistry } from '../index';\r\nimport { compileFieldResolver } from './resolver';\r\nimport { compileFieldArgs } from '~/domains/arg';\r\nimport { enhanceType, isRootFieldOnNonRootBase, resolveRegisteredOrInferedType, validateResolvedType, } from './services';\r\nimport { validateNotInferableField } from './fieldType';\r\nexport function compileFieldConfig(target, fieldName) {\r\n    const { type, description, isNullable } = fieldsRegistry.get(target, fieldName);\r\n    const args = compileFieldArgs(target, fieldName);\r\n    const resolvedType = resolveRegisteredOrInferedType(target, fieldName, type);\r\n    // if was not able to resolve type, try to show some helpful information about it\r\n    if (!resolvedType && !validateNotInferableField(target, fieldName)) {\r\n        return;\r\n    }\r\n    // show error about being not able to resolve field type\r\n    if (!validateResolvedType(target, fieldName, resolvedType)) {\r\n        validateNotInferableField(target, fieldName);\r\n        return;\r\n    }\r\n    const finalType = enhanceType(resolvedType, isNullable);\r\n    return {\r\n        description,\r\n        type: finalType,\r\n        resolve: compileFieldResolver(target, fieldName),\r\n        args,\r\n    };\r\n}\r\nfunction getAllFields(target) {\r\n    const fields = fieldsRegistry.getAll(target);\r\n    const finalFieldsMap = {};\r\n    Object.keys(fields).forEach(fieldName => {\r\n        if (isRootFieldOnNonRootBase(target, fieldName)) {\r\n            throw new FieldError(target, fieldName, `Given field is root field (@Query or @Mutation) not registered inside @Schema type. `);\r\n        }\r\n        const config = fieldsRegistry.get(target, fieldName);\r\n        finalFieldsMap[config.name] = compileFieldConfig(target, fieldName);\r\n    });\r\n    return finalFieldsMap;\r\n}\r\nexport function compileAllFields(target) {\r\n    const targetWithParents = getClassWithAllParentClasses(target);\r\n    const finalFieldsMap = {};\r\n    targetWithParents.forEach(targetLevel => {\r\n        Object.assign(finalFieldsMap, getAllFields(targetLevel));\r\n    });\r\n    return finalFieldsMap;\r\n}\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/domains/field/compiler/index.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,4BAA4B,EAAE,MAAM,8BAA8B,CAAC;AAC5E,OAAO,EAAE,UAAU,EAAE,cAAc,EAAE,MAAM,UAAU,CAAC;AAEtD,OAAO,EAAE,oBAAoB,EAAE,MAAM,YAAY,CAAC;AAClD,OAAO,EAAE,gBAAgB,EAAE,MAAM,eAAe,CAAC;AACjD,OAAO,EACL,WAAW,EACX,wBAAwB,EACxB,8BAA8B,EAC9B,oBAAoB,GACrB,MAAM,YAAY,CAAC;AAEpB,OAAO,EAAE,yBAAyB,EAAE,MAAM,aAAa,CAAC;AAExD,MAAM,UAAU,kBAAkB,CAChC,MAAgB,EAChB,SAAiB;IAEjB,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,cAAc,CAAC,GAAG,CAC1D,MAAM,EACN,SAAS,CACV,CAAC;IACF,MAAM,IAAI,GAAG,gBAAgB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAEjD,MAAM,YAAY,GAAG,8BAA8B,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;IAE7E,iFAAiF;IACjF,IAAI,CAAC,YAAY,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;QAClE,OAAO;KACR;IAED,wDAAwD;IACxD,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,SAAS,EAAE,YAAY,CAAC,EAAE;QAC1D,yBAAyB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QAC7C,OAAO;KACR;IAED,MAAM,SAAS,GAAG,WAAW,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;IAExD,OAAO;QACL,WAAW;QACX,IAAI,EAAE,SAAS;QACf,OAAO,EAAE,oBAAoB,CAAC,MAAM,EAAE,SAAS,CAAC;QAChD,IAAI;KACL,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,MAAgB;IACpC,MAAM,MAAM,GAAG,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAC7C,MAAM,cAAc,GAAoC,EAAE,CAAC;IAC3D,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;QACtC,IAAI,wBAAwB,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;YAC/C,MAAM,IAAI,UAAU,CAClB,MAAM,EACN,SAAS,EACT,sFAAsF,CACvF,CAAC;SACH;QAED,MAAM,MAAM,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACrD,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,kBAAkB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IACtE,CAAC,CAAC,CAAC;IACH,OAAO,cAAc,CAAC;AACxB,CAAC;AAED,MAAM,UAAU,gBAAgB,CAAC,MAAgB;IAC/C,MAAM,iBAAiB,GAAG,4BAA4B,CAAC,MAAM,CAAC,CAAC;IAE/D,MAAM,cAAc,GAAoC,EAAE,CAAC;IAE3D,iBAAiB,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;QACtC,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC,CAAC;IAC3D,CAAC,CAAC,CAAC;IACH,OAAO,cAAc,CAAC;AACxB,CAAC\"}","dts":{"name":"/Users/adampietrasiak/dev/oss/typegql/domains/field/compiler/index.d.ts","writeByteOrderMark":false,"text":"import { GraphQLFieldConfig, GraphQLFieldConfigMap } from 'graphql';\r\nexport declare function compileFieldConfig(target: Function, fieldName: string): GraphQLFieldConfig<any, any, any>;\r\nexport declare function compileAllFields(target: Function): GraphQLFieldConfigMap<any, any, {\r\n    [key: string]: any;\r\n}>;\r\n"}}

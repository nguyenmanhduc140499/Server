{"code":"import { getClassWithAllParentClasses } from '~/services/utils/inheritance';\r\nimport { FieldError, fieldsRegistry } from '../index';\r\nimport { compileFieldResolver } from './resolver';\r\nimport { compileFieldArgs } from '~/domains/arg';\r\nimport { enhanceType, isRootFieldOnNonRootBase, resolveRegisteredOrInferedType, validateResolvedType, } from './services';\r\nimport { validateNotInferableField } from './fieldType';\r\nexport function compileFieldConfig(target, fieldName) {\r\n    var _a = fieldsRegistry.get(target, fieldName), type = _a.type, description = _a.description, isNullable = _a.isNullable;\r\n    var args = compileFieldArgs(target, fieldName);\r\n    var resolvedType = resolveRegisteredOrInferedType(target, fieldName, type);\r\n    // if was not able to resolve type, try to show some helpful information about it\r\n    if (!resolvedType && !validateNotInferableField(target, fieldName)) {\r\n        return;\r\n    }\r\n    // show error about being not able to resolve field type\r\n    if (!validateResolvedType(target, fieldName, resolvedType)) {\r\n        validateNotInferableField(target, fieldName);\r\n        return;\r\n    }\r\n    var finalType = enhanceType(resolvedType, isNullable);\r\n    return {\r\n        description: description,\r\n        type: finalType,\r\n        resolve: compileFieldResolver(target, fieldName),\r\n        args: args,\r\n    };\r\n}\r\nfunction getAllFields(target) {\r\n    var fields = fieldsRegistry.getAll(target);\r\n    var finalFieldsMap = {};\r\n    Object.keys(fields).forEach(function (fieldName) {\r\n        if (isRootFieldOnNonRootBase(target, fieldName)) {\r\n            throw new FieldError(target, fieldName, \"Given field is root field (@Query or @Mutation) not registered inside @Schema type. \");\r\n        }\r\n        var config = fieldsRegistry.get(target, fieldName);\r\n        finalFieldsMap[config.name] = compileFieldConfig(target, fieldName);\r\n    });\r\n    return finalFieldsMap;\r\n}\r\nexport function compileAllFields(target) {\r\n    var targetWithParents = getClassWithAllParentClasses(target);\r\n    var finalFieldsMap = {};\r\n    targetWithParents.forEach(function (targetLevel) {\r\n        Object.assign(finalFieldsMap, getAllFields(targetLevel));\r\n    });\r\n    return finalFieldsMap;\r\n}\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/domains/field/compiler/index.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,4BAA4B,EAAE,MAAM,8BAA8B,CAAC;AAC5E,OAAO,EAAE,UAAU,EAAE,cAAc,EAAE,MAAM,UAAU,CAAC;AAEtD,OAAO,EAAE,oBAAoB,EAAE,MAAM,YAAY,CAAC;AAClD,OAAO,EAAE,gBAAgB,EAAE,MAAM,eAAe,CAAC;AACjD,OAAO,EACL,WAAW,EACX,wBAAwB,EACxB,8BAA8B,EAC9B,oBAAoB,GACrB,MAAM,YAAY,CAAC;AAEpB,OAAO,EAAE,yBAAyB,EAAE,MAAM,aAAa,CAAC;AAExD,MAAM,UAAU,kBAAkB,CAChC,MAAgB,EAChB,SAAiB;IAEX,IAAA,0CAGL,EAHO,cAAI,EAAE,4BAAW,EAAE,0BAG1B,CAAC;IACF,IAAM,IAAI,GAAG,gBAAgB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAEjD,IAAM,YAAY,GAAG,8BAA8B,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;IAE7E,iFAAiF;IACjF,IAAI,CAAC,YAAY,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;QAClE,OAAO;KACR;IAED,wDAAwD;IACxD,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,SAAS,EAAE,YAAY,CAAC,EAAE;QAC1D,yBAAyB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QAC7C,OAAO;KACR;IAED,IAAM,SAAS,GAAG,WAAW,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;IAExD,OAAO;QACL,WAAW,aAAA;QACX,IAAI,EAAE,SAAS;QACf,OAAO,EAAE,oBAAoB,CAAC,MAAM,EAAE,SAAS,CAAC;QAChD,IAAI,MAAA;KACL,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,MAAgB;IACpC,IAAM,MAAM,GAAG,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAC7C,IAAM,cAAc,GAAoC,EAAE,CAAC;IAC3D,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAA,SAAS;QACnC,IAAI,wBAAwB,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;YAC/C,MAAM,IAAI,UAAU,CAClB,MAAM,EACN,SAAS,EACT,sFAAsF,CACvF,CAAC;SACH;QAED,IAAM,MAAM,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACrD,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,kBAAkB,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IACtE,CAAC,CAAC,CAAC;IACH,OAAO,cAAc,CAAC;AACxB,CAAC;AAED,MAAM,UAAU,gBAAgB,CAAC,MAAgB;IAC/C,IAAM,iBAAiB,GAAG,4BAA4B,CAAC,MAAM,CAAC,CAAC;IAE/D,IAAM,cAAc,GAAoC,EAAE,CAAC;IAE3D,iBAAiB,CAAC,OAAO,CAAC,UAAA,WAAW;QACnC,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC,CAAC;IAC3D,CAAC,CAAC,CAAC;IACH,OAAO,cAAc,CAAC;AACxB,CAAC\"}"}
